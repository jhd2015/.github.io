var A=Object.defineProperty,q=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var y=(i,t,o)=>t in i?A(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,N=(i,t)=>{for(var o in t||(t={}))P.call(t,o)&&y(i,o,t[o]);if(w)for(var o of w(t))K.call(t,o)&&y(i,o,t[o]);return i},k=(i,t)=>q(i,O(t));import{S as z}from"./sortable.esm-DLvoQ0uI.js";import{c as H,h as I,a as J,R as W,b as Y,d as G}from"./index-1t1L-bbz.js";import{F as Q,_ as X}from"./index-Bfc9F0Lp.js";function Z(){const i=s=>{s.preventDefault(),Vue.nextTick(()=>{const r=document.querySelector(".el-table__body-wrapper tbody");z.create(r,{animation:300,handle:".drag-btn",onEnd:({newIndex:e,oldIndex:V})=>{const a=t.value.list.splice(V,1)[0];t.value.list.splice(e,0,a)}})})},t=Vue.ref({list:[],isLoading:!1});function o(){t.value.isLoading=!0,I({}).then(s=>{t.value.list=s.map(r=>(typeof r.img=="string"&&(r.img=r.img.split(",")),r))}).finally(()=>{t.value.isLoading=!1})}const c=Vue.ref([{type:"selection",align:"left"},{label:"序号",prop:"id",cellRenderer:({row:s})=>Vue.createVNode("div",{class:"flex items-center"},[Vue.createVNode(Vue.resolveComponent("iconify-icon-online"),{icon:"icon-park-outline:drag",class:"drag-btn cursor-grab",onMouseenter:r=>i(r)},null),Vue.createVNode("p",{class:"ml-[16px]"},[s.id])])},{label:"封面",prop:"img",slot:"img"},{label:"编号",prop:"number"},{label:"标题",prop:"title",width:300},{label:"一级分类",prop:"month",headerSlot:"jointLevel1"},{label:"二级分类",prop:"festival",headerSlot:"jointLevel2"},{label:"三级分类",prop:"name",headerSlot:"jointLevel3"},{label:"格式",prop:"name"},{label:"状态",prop:"state",slot:"state"},{label:"更新日期",prop:"name"},{label:"操作",prop:"name",width:200,slot:"operation"}]),u=[{value:1,label:"Asia",children:[{value:2,label:"China",children:[{value:3,label:"Beijing"},{value:4,label:"Shanghai"},{value:5,label:"Hangzhou"}]},{value:6,label:"Japan",children:[{value:7,label:"Tokyo"},{value:8,label:"Osaka"},{value:9,label:"Kyoto"}]},{value:10,label:"Korea",children:[{value:11,label:"Seoul"},{value:12,label:"Busan"},{value:13,label:"Taegu"}]}]},{value:14,label:"Europe",children:[{value:15,label:"France",children:[{value:16,label:"Paris"},{value:17,label:"Marseille"},{value:18,label:"Lyon"}]},{value:19,label:"UK",children:[{value:20,label:"London"},{value:21,label:"Birmingham"},{value:22,label:"Manchester"}]}]},{value:23,label:"North America",children:[{value:24,label:"US",children:[{value:25,label:"New York"},{value:26,label:"Los Angeles"},{value:27,label:"Washington"}]},{value:28,label:"Canada",children:[{value:29,label:"Toronto"},{value:30,label:"Montreal"},{value:31,label:"Ottawa"}]}]}];function v(s){}function f(s){ElementPlus.ElMessageBox.confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{J({id:s}).then(()=>{ElementPlus.ElMessage.success("删除成功"),o()})}).catch(()=>{ElementPlus.ElMessage.info("已取消删除")})}return{columns:c,tableData:t,options:u,handleSelectionChange:v,loadData:o,copyTextToClipboard:H,handDelete:f}}const ee={class:"dialog-footer"},le=Vue.defineComponent({__name:"DialogForm",props:Vue.mergeModels({data:{default:{_id:"",number:"",title:"",month:"",festival:"",baiduLink:"",img:[]}}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:Vue.mergeModels(["refresh"],["update:modelValue"]),setup(i,{emit:t}){const o=Vue.useModel(i,"modelValue"),c=i,u=Vue.ref({_id:"",number:"",title:"",month:"",festival:"",baiduLink:"",img:[]});Vue.watch(()=>o.value,()=>{var r;u.value=k(N({},c.data),{img:(r=c.data.img)==null?void 0:r.map(e=>({url:e,status:"success"}))})});const v=t,f=Vue.reactive({number:[{required:!0,message:"不可以为空"}],title:[{required:!0,message:"不可以为空"}],baiduLink:[{required:!0,message:"不可以为空"}],month:[{required:!0,message:"不可以为空"}],img:[{type:"array",required:!0,message:"不可以为空"}],festival:[{required:!0,message:"不可以为空"}]});function s(){var V;const r=k(N({},u.value),{img:u.value.img.map(a=>{var p;return((p=a==null?void 0:a.response)==null?void 0:p.file)||a.url})}),e=new FormData;for(const a in r)Object.prototype.hasOwnProperty.call(r,a)&&(a=="img"?r[a].forEach((p,m)=>{e.append(`img[${m}]`,p)}):e.append(a,r[a]));(V=u.value)!=null&&V._id?(e.append("id",u.value._id),Y(e).then(()=>{o.value=!1,v("refresh")})):G(e).then(()=>{o.value=!1,v("refresh")})}return(r,e)=>{var h;const V=Vue.resolveComponent("el-input"),a=Vue.resolveComponent("el-form-item"),p=Vue.resolveComponent("el-form"),m=Vue.resolveComponent("el-button"),C=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createBlock(C,{modelValue:o.value,"onUpdate:modelValue":e[7]||(e[7]=n=>o.value=n),title:`${(h=c.data)!=null&&h.id?"新增":"编辑"}手抄报`,width:"500"},{footer:Vue.withCtx(()=>[Vue.createElementVNode("div",ee,[Vue.createVNode(m,{onClick:e[6]||(e[6]=n=>o.value=!1)},{default:Vue.withCtx(()=>e[9]||(e[9]=[Vue.createTextVNode("取消")])),_:1}),Vue.createVNode(m,{type:"primary",onClick:s},{default:Vue.withCtx(()=>e[10]||(e[10]=[Vue.createTextVNode(" 确认 ")])),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(p,{ref:"ruleFormRef","label-position":"top",model:u.value,rules:f,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:Vue.withCtx(()=>[Vue.createVNode(a,{label:"编号",prop:"number"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{modelValue:u.value.number,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value.number=n),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),Vue.createVNode(a,{label:"标题",prop:"title"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{modelValue:u.value.title,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value.title=n),"show-word-limit":"",maxlength:"200",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),Vue.createVNode(a,{label:"月分",prop:"month"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{modelValue:u.value.month,"onUpdate:modelValue":e[2]||(e[2]=n=>u.value.month=n),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),Vue.createVNode(a,{label:"节曰",prop:"festival"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{modelValue:u.value.festival,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.festival=n),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),Vue.createVNode(a,{label:"百度云链接",prop:"baiduLink"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{modelValue:u.value.baiduLink,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.baiduLink=n),maxlength:"200",autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),Vue.createVNode(a,{prop:"img"},{label:Vue.withCtx(()=>e[8]||(e[8]=[Vue.createTextVNode(" 上传 ")])),default:Vue.withCtx(()=>[Vue.createVNode(W,{modelValue:u.value.img,"onUpdate:modelValue":e[5]||(e[5]=n=>u.value.img=n),name:"handCopy"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),te={class:"flex"},oe={class:"head"},ae={key:0},ue={class:"table_operation"},ne=Vue.defineComponent({name:"thandCopyList",__name:"index",setup(i){const{columns:t,tableData:o,options:c,handleSelectionChange:u,loadData:v,copyTextToClipboard:f,handDelete:s}=Z();Vue.onMounted(()=>{v()});const r=Vue.ref([]),e=Vue.ref(),V=Vue.ref(),a=()=>{var n,l;(l=(n=Vue.unref(V).popperRef)==null?void 0:n.delayHide)==null||l.call(n)},p=Vue.ref(""),m=Vue.ref(!1),C=Vue.ref({});function h(n){m.value=!0,C.value=n}return(n,l)=>{const E=Vue.resolveComponent("el-input"),b=Vue.resolveComponent("el-button"),T=Vue.resolveComponent("el-image"),B=Vue.resolveComponent("el-tag"),L=Vue.resolveComponent("Link"),g=Vue.resolveComponent("el-icon"),D=Vue.resolveComponent("Remove"),R=Vue.resolveComponent("Top"),S=Vue.resolveComponent("Bottom"),U=Vue.resolveComponent("Edit"),M=Vue.resolveComponent("pure-table"),F=Vue.resolveComponent("el-cascader-panel"),$=Vue.resolveComponent("el-popover"),_=Vue.resolveDirective("click-outside");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",te,[Vue.createElementVNode("div",oe,[l[9]||(l[9]=Vue.createElementVNode("div",null,"手抄报列表",-1)),Vue.createElementVNode("div",null,[Vue.createVNode(E,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=d=>p.value=d),"suffix-icon":Vue.unref(Q),style:{width:"240px","margin-right":"20px"},placeholder:"请输入"},null,8,["modelValue","suffix-icon"]),Vue.createVNode(b,null,{default:Vue.withCtx(()=>l[4]||(l[4]=[Vue.createTextVNode("批量上架")])),_:1}),Vue.createVNode(b,null,{default:Vue.withCtx(()=>l[5]||(l[5]=[Vue.createTextVNode("批量下架")])),_:1}),Vue.createVNode(b,null,{default:Vue.withCtx(()=>l[6]||(l[6]=[Vue.createTextVNode("批量删除")])),_:1}),Vue.createVNode(b,{type:"primary"},{default:Vue.withCtx(()=>l[7]||(l[7]=[Vue.createTextVNode("设置免费")])),_:1}),Vue.createVNode(b,{type:"primary",onClick:l[1]||(l[1]=d=>m.value=!0)},{default:Vue.withCtx(()=>l[8]||(l[8]=[Vue.createTextVNode("新增")])),_:1})])]),Vue.createVNode(M,{"row-key":"id",data:Vue.unref(o).list,loading:Vue.unref(o).isLoading,columns:Vue.unref(t),onSelectionChange:Vue.unref(u)},{img:Vue.withCtx(({row:d})=>[d!=null&&d.img?(Vue.openBlock(),Vue.createElementBlock("div",ae,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(d.img,(x,j)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:j},[Vue.createVNode(T,{src:x},null,8,["src"])]))),128))])):Vue.createCommentVNode("",!0)]),jointLevel1:Vue.withCtx(()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{ref_key:"buttonRef",ref:e},l[10]||(l[10]=[Vue.createTextVNode("一级分类")]))),[[_,a]])]),jointLevel2:Vue.withCtx(()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",null,l[11]||(l[11]=[Vue.createTextVNode("二级分类")]))),[[_,a]])]),jointLevel3:Vue.withCtx(()=>[Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",null,l[12]||(l[12]=[Vue.createTextVNode("三级分类")]))),[[_,a]])]),state:Vue.withCtx(()=>[Vue.createVNode(B,{type:"primary"},{default:Vue.withCtx(()=>l[13]||(l[13]=[Vue.createTextVNode("状态")])),_:1})]),operation:Vue.withCtx(({row:d})=>[Vue.createElementVNode("div",ue,[Vue.createVNode(g,{onClick:x=>Vue.unref(f)(d.baiduLink)},{default:Vue.withCtx(()=>[Vue.createVNode(L)]),_:2},1032,["onClick"]),Vue.createVNode(g,{onClick:x=>Vue.unref(s)(d._id)},{default:Vue.withCtx(()=>[Vue.createVNode(D)]),_:2},1032,["onClick"]),Vue.createVNode(g,null,{default:Vue.withCtx(()=>[Vue.createVNode(R)]),_:1}),Vue.createVNode(g,null,{default:Vue.withCtx(()=>[Vue.createVNode(S)]),_:1}),Vue.createVNode(g,{onClick:x=>h(d)},{default:Vue.withCtx(()=>[Vue.createVNode(U)]),_:2},1032,["onClick"])])]),_:1},8,["data","loading","columns","onSelectionChange"]),Vue.createVNode($,{ref_key:"popoverRef",ref:V,"virtual-ref":e.value,width:"400px",trigger:"click","virtual-triggering":"",placement:"bottom-start"},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(F,{modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=d=>r.value=d),props:{multiple:!0},options:Vue.unref(c)},null,8,["modelValue","options"])])]),_:1},8,["virtual-ref"])]),Vue.createVNode(le,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=d=>m.value=d),data:C.value,onRefresh:Vue.unref(v)},null,8,["modelValue","data","onRefresh"])],64)}}}),se=X(ne,[["__scopeId","data-v-7fbbc41c"]]);export{se as default};
