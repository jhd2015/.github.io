var Y=Object.defineProperty,G=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var U=(t,n,l)=>n in t?Y(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,M=(t,n)=>{for(var l in n||(n={}))W.call(n,l)&&U(t,l,n[l]);if(D)for(var l of D(n))q.call(n,l)&&U(t,l,n[l]);return t},F=(t,n)=>G(t,Q(n));var N=(t,n,l)=>new Promise((g,v)=>{var u=s=>{try{_(l.next(s))}catch(f){v(f)}},b=s=>{try{_(l.throw(s))}catch(f){v(f)}},_=s=>s.done?g(s.value):Promise.resolve(s.value).then(u,b);_((l=l.apply(t,n)).next())});import{n as m,t as P,aN as X,aF as Z,aG as L,d as E,aH as T,aI as w,az as ee,J as le,g as ae,h as p,r,Y as ne,o as A,e as V,b as i,f as z,aO as te,x as oe,c as ie,u as d,aa as ue,aL as se,Q as re,aJ as de,_ as pe}from"./index-DLJRaqXF.js";import{a as ce}from"./teachingAids-DNNiPRtZ.js";function me(){const t=m({list:[],isLoading:!1}),n=m(""),l=P({pageSize:20,currentPage:1,pageSizes:[20,40,60],total:0,align:"right",background:!0,size:"default"});function g(){u()}function v(){u()}function u(){t.value.isLoading=!0,X({pageSize:l.pageSize,pageNum:l.currentPage,phoneNumber:n.value}).then(e=>{t.value.list=e.list,l.total=e.total}).finally(()=>{t.value.isLoading=!1})}const b=m([{type:"index",label:"序号",width:100},{label:"手机号",prop:"phone_info.phoneNumber",width:150},{label:"状态",prop:"state",slot:"state"},{label:"星币",prop:"myCoin"},{label:"邀请人数",prop:"myInviteUser",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.myInviteUser)==null?void 0:a.length}},{label:"分享人数",prop:"share"},{label:"购买数",prop:"likes",cellRenderer({row:e}){var a,o;return((a=e==null?void 0:e.buysMaterial)==null?void 0:a.length)+((o=e==null?void 0:e.buys)==null?void 0:o.length)}},{label:"手抄报点赞",prop:"likes",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.likes)==null?void 0:a.length}},{label:"教辅资料点赞",prop:"likes",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.likesMaterial)==null?void 0:a.length}},{label:"创建时间",prop:"date",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.date)==null?void 0:a.slice(0,10)}},{label:"操作",prop:"name",slot:"operation"}]),_=[{value:1,label:"Asia",children:[{value:2,label:"China",children:[{value:3,label:"Beijing"},{value:4,label:"Shanghai"},{value:5,label:"Hangzhou"}]},{value:6,label:"Japan",children:[{value:7,label:"Tokyo"},{value:8,label:"Osaka"},{value:9,label:"Kyoto"}]},{value:10,label:"Korea",children:[{value:11,label:"Seoul"},{value:12,label:"Busan"},{value:13,label:"Taegu"}]}]},{value:14,label:"Europe",children:[{value:15,label:"France",children:[{value:16,label:"Paris"},{value:17,label:"Marseille"},{value:18,label:"Lyon"}]},{value:19,label:"UK",children:[{value:20,label:"London"},{value:21,label:"Birmingham"},{value:22,label:"Manchester"}]}]},{value:23,label:"North America",children:[{value:24,label:"US",children:[{value:25,label:"New York"},{value:26,label:"Los Angeles"},{value:27,label:"Washington"}]},{value:28,label:"Canada",children:[{value:29,label:"Toronto"},{value:30,label:"Montreal"},{value:31,label:"Ottawa"}]}]}];function s(e){}function f(e){Z.confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ce({id:e}).then(()=>{L.success("删除成功"),u()})}).catch(()=>{L.info("已取消删除")})}return{columns:b,loadData:u,options:_,tableData:t,handDelete:f,handleSelectionChange:s,searchModel:n,pagination:l,onSizeChange:g,onCurrentChange:v}}const ve={class:"dialog-footer"},fe=E({__name:"DialogForm",props:T({data:{default:{_id:"",name:""}}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:T(["refresh"],["update:modelValue"]),setup(t,{emit:n}){const l=w(t,"modelValue"),g=t;function v(){l.value=!1}ee();const u=m({id:"",name:"",coin:0});le(()=>l.value,()=>{ne(()=>{u.value=F(M({},g.data),{name:g.data.phone_info.phoneNumber,id:g.data._id,coin:0}),f.value.resetFields()})});const b=P({}),_=n,s=m(!1),f=m();function e(){return N(this,null,function*(){s.value=!0;const a=M({},u.value),o=new FormData;for(const y in a)Object.prototype.hasOwnProperty.call(a,y)&&o.append(y,a[y]);te(o).then(()=>{l.value=!1,_("refresh")}).finally(()=>{s.value=!1})})}return(a,o)=>{const y=r("el-input"),k=r("el-form-item"),S=r("el-input-number"),R=r("el-form"),x=r("el-button"),c=r("el-dialog");return A(),ae(c,{modelValue:l.value,"onUpdate:modelValue":o[3]||(o[3]=h=>l.value=h),title:"添加星币",width:"500","before-close":v},{footer:p(()=>[V("div",ve,[i(x,{onClick:o[2]||(o[2]=h=>l.value=!1)},{default:p(()=>o[4]||(o[4]=[z("取消")])),_:1}),i(x,{type:"primary",loading:s.value,onClick:e},{default:p(()=>o[5]||(o[5]=[z(" 确认 ")])),_:1},8,["loading"])])]),default:p(()=>[i(R,{ref_key:"ruleFormRef",ref:f,"label-position":"top",model:u.value,rules:b,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:p(()=>[i(k,{label:"昵称",prop:"name"},{default:p(()=>[i(y,{modelValue:u.value.name,"onUpdate:modelValue":o[0]||(o[0]=h=>u.value.name=h),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),i(k,{label:"星币",prop:"coin"},{default:p(()=>[i(S,{modelValue:u.value.coin,"onUpdate:modelValue":o[1]||(o[1]=h=>u.value.coin=h),min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),ge={class:"flex"},be={class:"head"},_e={class:"table_operation"},he=E({__name:"index",setup(t){const{columns:n,tableData:l,handDelete:g,loadData:v,options:u,searchModel:b,handleSelectionChange:_,pagination:s,onSizeChange:f,onCurrentChange:e}=me(),a=m([]),o=m(),y=m();oe(()=>{v()});const k=m(!1),S=m({});function R(x){k.value=!0,S.value=x}return(x,c)=>{const h=r("el-input"),K=r("el-tag"),O=r("Remove"),B=r("el-icon"),$=r("Edit"),I=r("pure-table"),j=r("el-cascader-panel"),J=r("el-popover");return A(),ie(re,null,[V("div",ge,[V("div",be,[c[3]||(c[3]=V("div",null,"用户列表",-1)),V("div",null,[i(h,{modelValue:d(b),"onUpdate:modelValue":c[0]||(c[0]=C=>ue(b)?b.value=C:null),"suffix-icon":d(de),style:{width:"240px","margin-right":"20px"},placeholder:"请输入手机号码",onKeyup:se(d(v),["enter"])},null,8,["modelValue","suffix-icon","onKeyup"])])]),i(I,{"row-key":"id",data:d(l).list,loading:d(l).isLoading,columns:d(n),adaptive:"",pagination:d(s),onSelectionChange:d(_),onPageSizeChange:d(f),onPageCurrentChange:d(e)},{state:p(()=>[i(K,{type:"primary"},{default:p(()=>c[4]||(c[4]=[z("状态")])),_:1})]),operation:p(({row:C})=>[V("div",_e,[i(B,{onClick:H=>d(g)(C._id)},{default:p(()=>[i(O)]),_:2},1032,["onClick"]),i(B,{onClick:H=>R(C)},{default:p(()=>[i($)]),_:2},1032,["onClick"])])]),_:1},8,["data","loading","columns","pagination","onSelectionChange","onPageSizeChange","onPageCurrentChange"]),i(J,{ref_key:"popoverRef",ref:y,"virtual-ref":o.value,width:"400px",trigger:"click","virtual-triggering":"",placement:"bottom-start"},{default:p(()=>[V("div",null,[i(j,{modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=C=>a.value=C),props:{multiple:!0},options:d(u)},null,8,["modelValue","options"])])]),_:1},8,["virtual-ref"])]),i(fe,{modelValue:k.value,"onUpdate:modelValue":c[2]||(c[2]=C=>k.value=C),data:S.value,onRefresh:d(v)},null,8,["modelValue","data","onRefresh"])],64)}}}),ke=pe(he,[["__scopeId","data-v-e5b26e31"]]);export{ke as default};
