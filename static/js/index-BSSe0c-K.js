var z=Object.defineProperty,H=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var S=(o,n,l)=>n in o?z(o,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[n]=l,B=(o,n)=>{for(var l in n||(n={}))P.call(n,l)&&S(o,l,n[l]);if(F)for(var l of F(n))Y.call(n,l)&&S(o,l,n[l]);return o},T=(o,n)=>H(o,I(n));var U=(o,n,l)=>new Promise((m,v)=>{var d=i=>{try{a(l.next(i))}catch(b){v(b)}},e=i=>{try{a(l.throw(i))}catch(b){v(b)}},a=i=>i.done?m(i.value):Promise.resolve(i.value).then(d,e);a((l=l.apply(o,n)).next())});import{a as G}from"./teachingAids-CgSw68Fz.js";import{n as c,aN as Q,aF as W,aG as L,d as E,aH as N,aI as q,az as X,J as Z,t as w,g as ee,h as r,r as u,Y as le,o as A,e as y,b as s,f as D,aO as ae,x as ne,c as oe,u as h,Q as te,aJ as se,_ as ie}from"./index-mO-B51ho.js";function ue(){const o=c({list:[],isLoading:!1});function n(){o.value.isLoading=!0,Q({}).then(e=>{o.value.list=e.map(a=>(typeof a.img=="string"&&(a.img=a.img.split(",")),a))}).finally(()=>{o.value.isLoading=!1})}const l=c([{type:"index",label:"序号",width:100},{label:"手机号",prop:"phone_info.phoneNumber",width:150},{label:"状态",prop:"state",slot:"state"},{label:"星币",prop:"myCoin"},{label:"购买数",prop:"likes",cellRenderer({row:e}){var a,i;return((a=e==null?void 0:e.buysMaterial)==null?void 0:a.length)+((i=e==null?void 0:e.buys)==null?void 0:i.length)}},{label:"手抄报点赞",prop:"likes",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.likes)==null?void 0:a.length}},{label:"教辅资料点赞",prop:"likes",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.likesMaterial)==null?void 0:a.length}},{label:"创建时间",prop:"date",cellRenderer({row:e}){var a;return(a=e==null?void 0:e.date)==null?void 0:a.slice(0,10)}},{label:"操作",prop:"name",slot:"operation"}]),m=[{value:1,label:"Asia",children:[{value:2,label:"China",children:[{value:3,label:"Beijing"},{value:4,label:"Shanghai"},{value:5,label:"Hangzhou"}]},{value:6,label:"Japan",children:[{value:7,label:"Tokyo"},{value:8,label:"Osaka"},{value:9,label:"Kyoto"}]},{value:10,label:"Korea",children:[{value:11,label:"Seoul"},{value:12,label:"Busan"},{value:13,label:"Taegu"}]}]},{value:14,label:"Europe",children:[{value:15,label:"France",children:[{value:16,label:"Paris"},{value:17,label:"Marseille"},{value:18,label:"Lyon"}]},{value:19,label:"UK",children:[{value:20,label:"London"},{value:21,label:"Birmingham"},{value:22,label:"Manchester"}]}]},{value:23,label:"North America",children:[{value:24,label:"US",children:[{value:25,label:"New York"},{value:26,label:"Los Angeles"},{value:27,label:"Washington"}]},{value:28,label:"Canada",children:[{value:29,label:"Toronto"},{value:30,label:"Montreal"},{value:31,label:"Ottawa"}]}]}];function v(e){}function d(e){W.confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{G({id:e}).then(()=>{L.success("删除成功"),n()})}).catch(()=>{L.info("已取消删除")})}return{columns:l,loadData:n,options:m,tableData:o,handDelete:d,handleSelectionChange:v}}const de={class:"dialog-footer"},re=E({__name:"DialogForm",props:N({data:{default:{_id:"",name:""}}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:N(["refresh"],["update:modelValue"]),setup(o,{emit:n}){const l=q(o,"modelValue"),m=o;function v(){l.value=!1}X();const d=c({id:"",name:"",coin:0});Z(()=>l.value,()=>{le(()=>{d.value=T(B({},m.data),{name:m.data.phone_info.phoneNumber,id:m.data._id,coin:0}),b.value.resetFields()})});const e=w({}),a=n,i=c(!1),b=c();function x(){return U(this,null,function*(){i.value=!0;const _=B({},d.value),t=new FormData;for(const V in _)Object.prototype.hasOwnProperty.call(_,V)&&t.append(V,_[V]);ae(t).then(()=>{l.value=!1,a("refresh")}).finally(()=>{i.value=!1})})}return(_,t)=>{const V=u("el-input"),k=u("el-form-item"),p=u("el-input-number"),R=u("el-form"),C=u("el-button"),M=u("el-dialog");return A(),ee(M,{modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=f=>l.value=f),title:"添加星币",width:"500","before-close":v},{footer:r(()=>[y("div",de,[s(C,{onClick:t[2]||(t[2]=f=>l.value=!1)},{default:r(()=>t[4]||(t[4]=[D("取消")])),_:1}),s(C,{type:"primary",loading:i.value,onClick:x},{default:r(()=>t[5]||(t[5]=[D(" 确认 ")])),_:1},8,["loading"])])]),default:r(()=>[s(R,{ref_key:"ruleFormRef",ref:b,"label-position":"top",model:d.value,rules:e,"label-width":"auto",class:"demo-ruleForm","status-icon":""},{default:r(()=>[s(k,{label:"昵称",prop:"name"},{default:r(()=>[s(V,{modelValue:d.value.name,"onUpdate:modelValue":t[0]||(t[0]=f=>d.value.name=f),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),s(k,{label:"星币",prop:"coin"},{default:r(()=>[s(p,{modelValue:d.value.coin,"onUpdate:modelValue":t[1]||(t[1]=f=>d.value.coin=f),min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),pe={class:"flex"},ce={class:"head"},me={class:"table_operation"},ve=E({__name:"index",setup(o){const{columns:n,tableData:l,handDelete:m,loadData:v,options:d,handleSelectionChange:e}=ue(),a=c([]),i=c(),b=c();ne(()=>{v()});const x=c(""),_=c(!1),t=c({});function V(k){_.value=!0,t.value=k}return(k,p)=>{const R=u("el-input"),C=u("el-tag"),M=u("Remove"),f=u("el-icon"),O=u("Edit"),$=u("pure-table"),j=u("el-cascader-panel"),J=u("el-popover");return A(),oe(te,null,[y("div",pe,[y("div",ce,[p[3]||(p[3]=y("div",null,"用户列表",-1)),y("div",null,[s(R,{modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=g=>x.value=g),"suffix-icon":h(se),style:{width:"240px","margin-right":"20px"},placeholder:"请输入"},null,8,["modelValue","suffix-icon"])])]),s($,{"row-key":"id",data:h(l).list,loading:h(l).isLoading,columns:h(n),onSelectionChange:h(e)},{state:r(()=>[s(C,{type:"primary"},{default:r(()=>p[4]||(p[4]=[D("状态")])),_:1})]),operation:r(({row:g})=>[y("div",me,[s(f,{onClick:K=>h(m)(g._id)},{default:r(()=>[s(M)]),_:2},1032,["onClick"]),s(f,{onClick:K=>V(g)},{default:r(()=>[s(O)]),_:2},1032,["onClick"])])]),_:1},8,["data","loading","columns","onSelectionChange"]),s(J,{ref_key:"popoverRef",ref:b,"virtual-ref":i.value,width:"400px",trigger:"click","virtual-triggering":"",placement:"bottom-start"},{default:r(()=>[y("div",null,[s(j,{modelValue:a.value,"onUpdate:modelValue":p[1]||(p[1]=g=>a.value=g),props:{multiple:!0},options:h(d)},null,8,["modelValue","options"])])]),_:1},8,["virtual-ref"])]),s(re,{modelValue:_.value,"onUpdate:modelValue":p[2]||(p[2]=g=>_.value=g),data:t.value,onRefresh:h(v)},null,8,["modelValue","data","onRefresh"])],64)}}}),ge=ie(ve,[["__scopeId","data-v-c9ea1ed5"]]);export{ge as default};
